{"version":3,"sources":["../source/index.js"],"names":["server","Koa","LEANCLOUD_APP_ID","LEANCLOUD_APP_KEY","LEANCLOUD_APP_MASTER_KEY","LEANCLOUD_APP_PORT","process","env","LC","init","appId","appKey","masterKey","use","context","next","error","console","status","body","message","koa2","Cloud","CookieSession","framework","secret","maxAge","fetchUser","app","listen"],"mappings":";;;;AAAA;;AAEA;;AAEA;;AAEA;;AAEA;;AAIA;;AAEA;;AAJA;AAMA,MAAMA,MAAM,GAAG,IAAIC,YAAJ,EAAf;AAAA,MACI;AACIC,EAAAA,gBADJ;AAEIC,EAAAA,iBAFJ;AAGIC,EAAAA,wBAHJ;AAIIC,EAAAA;AAJJ,IAKIC,OAAO,CAACC,GANhB;;AAQAC,oBAAGC,IAAH,CAAQ;AACJC,EAAAA,KAAK,EAAER,gBADH;AAEJS,EAAAA,MAAM,EAAER,iBAFJ;AAGJS,EAAAA,SAAS,EAAER;AAHP,CAAR;;AAMAJ,MAAM,CACDa,GADL,CACS,yBADT,EAEKA,GAFL,CAES,OAAOC,OAAP,EAAgBC,IAAhB,KAAyB;AAC1B,MAAI;AACA,UAAMA,IAAI,EAAV;AACH,GAFD,CAEE,OAAOC,KAAP,EAAc;AACZC,IAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AAECF,IAAAA,OAAO,CAACI,MAAR,GAAiB,CAACF,KAAK,CAACF,OAAN,IAAiB,EAAlB,EAAsBI,MAAtB,IAAgC,GAAlD,EACCJ,OAAO,CAACK,IAAR,GAAeH,KAAK,CAACI,OADtB;AAEH;AACJ,CAXL,EAYKP,GAZL,CAYSL,oBAAGa,IAAH,EAZT,EAaI;AAbJ,CAcKR,GAdL,CAeQL,oBAAGc,KAAH,CAASC,aAAT,CAAuB;AACnBC,EAAAA,SAAS,EAAE,MADQ;AAEnBC,EAAAA,MAAM,EAAEtB,iBAFW;AAGnBuB,EAAAA,MAAM,EAAE,OAHW;AAInBC,EAAAA,SAAS,EAAE;AAJQ,CAAvB,CAfR,EAsBKd,GAtBL,CAsBS,oBAtBT,EAuBKA,GAvBL,CAuBS,6BAvBT,EAwBKA,GAxBL,CAwBS,uBAAMe,QAAN,CAxBT,EAyBKC,MAzBL,CAyBYxB,kBAzBZ","sourcesContent":["import Koa from 'koa';\n\nimport Logger from 'koa-logger';\n\nimport mount from 'koa-mount';\n\nimport CORS from '@koa/cors';\n\nimport bodyParser from 'koa-bodyparser';\n\n//import CSRF from 'koa-csrf';\n\nimport LC from 'leanengine';\n\nimport { app } from './app';\n\nconst server = new Koa(),\n    {\n        LEANCLOUD_APP_ID,\n        LEANCLOUD_APP_KEY,\n        LEANCLOUD_APP_MASTER_KEY,\n        LEANCLOUD_APP_PORT\n    } = process.env;\n\nLC.init({\n    appId: LEANCLOUD_APP_ID,\n    appKey: LEANCLOUD_APP_KEY,\n    masterKey: LEANCLOUD_APP_MASTER_KEY\n});\n\nserver\n    .use(Logger())\n    .use(async (context, next) => {\n        try {\n            await next();\n        } catch (error) {\n            console.error(error);\n\n            (context.status = (error.context || '').status || 500),\n            (context.body = error.message);\n        }\n    })\n    .use(LC.koa2())\n    //    .use(new CSRF())\n    .use(\n        LC.Cloud.CookieSession({\n            framework: 'koa2',\n            secret: LEANCLOUD_APP_KEY,\n            maxAge: 3600000,\n            fetchUser: true\n        })\n    )\n    .use(CORS())\n    .use(bodyParser())\n    .use(mount(app))\n    .listen(LEANCLOUD_APP_PORT);\n"],"file":"index.js"}